<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Pokémon Battle Engine</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
      color: #333;
    }
    
    .game-container {
      background: rgba(255, 255, 255, 0.95);
      border-radius: 20px;
      padding: 30px;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
      max-width: 900px;
      width: 100%;
    }
    
    h1 {
      text-align: center;
      color: #764ba2;
      margin-bottom: 30px;
      font-size: 2.5em;
      text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
    }
    
    .setup-phase {
      text-align: center;
      margin-bottom: 30px;
    }
    
    .setup-phase select {
      padding: 10px 20px;
      margin: 0 10px;
      border: 2px solid #667eea;
      border-radius: 10px;
      font-size: 16px;
      background: white;
      cursor: pointer;
      transition: all 0.3s;
    }
    
    .setup-phase select:hover {
      border-color: #764ba2;
      transform: translateY(-2px);
    }
    
    .battle-arena {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 40px;
      margin-bottom: 30px;
    }
    
    .pokemon-card {
      background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
      border-radius: 15px;
      padding: 20px;
      text-align: center;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
      transition: transform 0.3s;
    }
    
    .pokemon-card:hover {
      transform: translateY(-5px);
    }
    
    .pokemon-card h2 {
      color: #333;
      margin-bottom: 15px;
      font-size: 1.8em;
    }
    
    .pokemon-card img {
      width: 180px;
      height: 180px;
      object-fit: contain;
      filter: drop-shadow(0 5px 15px rgba(0, 0, 0, 0.3));
      transition: transform 0.3s;
    }
    
    .pokemon-card img:hover {
      transform: scale(1.05);
    }
    
    .hp-container {
      margin-top: 15px;
      background: #333;
      border-radius: 10px;
      padding: 3px;
      box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.3);
    }
    
    .hp-bar {
      height: 20px;
      background: linear-gradient(90deg, #4ade80 0%, #22c55e 100%);
      border-radius: 8px;
      transition: width 0.5s ease-out;
      position: relative;
      overflow: hidden;
    }
    
    .hp-bar::after {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: linear-gradient(180deg, rgba(255,255,255,0.3) 0%, transparent 60%);
    }
    
    .hp-text {
      margin-top: 5px;
      font-weight: bold;
      color: #666;
    }
    
    .move-selection {
      background: #f8f9fa;
      border-radius: 15px;
      padding: 20px;
      margin-bottom: 20px;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
    }
    
    .move-selection h3 {
      color: #764ba2;
      margin-bottom: 15px;
    }
    
    .move-buttons {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 10px;
    }
    
    .move-btn {
      padding: 12px 20px;
      border: none;
      border-radius: 10px;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s;
      text-transform: capitalize;
      position: relative;
      overflow: hidden;
    }
    
    .move-btn::before {
      content: '';
      position: absolute;
      top: 50%;
      left: 50%;
      width: 0;
      height: 0;
      border-radius: 50%;
      background: rgba(255, 255, 255, 0.5);
      transform: translate(-50%, -50%);
      transition: width 0.6s, height 0.6s;
    }
    
    .move-btn:hover::before {
      width: 300px;
      height: 300px;
    }
    
    .move-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
    }
    
    .move-btn:disabled {
      opacity: 0.5;
      cursor: not-allowed;
      transform: none;
    }
    
    /* Type-based move button colors */
    .type-normal { background: #A8A878; color: white; }
    .type-fire { background: #F08030; color: white; }
    .type-water { background: #6890F0; color: white; }
    .type-electric { background: #F8D030; color: #333; }
    .type-grass { background: #78C850; color: white; }
    .type-ice { background: #98D8D8; color: #333; }
    .type-fighting { background: #C03028; color: white; }
    .type-poison { background: #A040A0; color: white; }
    .type-ground { background: #E0C068; color: #333; }
    .type-flying { background: #A890F0; color: white; }
    .type-psychic { background: #F85888; color: white; }
    .type-bug { background: #A8B820; color: white; }
    .type-rock { background: #B8A038; color: white; }
    .type-ghost { background: #705898; color: white; }
    .type-dragon { background: #7038F8; color: white; }
    .type-dark { background: #705848; color: white; }
    .type-steel { background: #B8B8D0; color: #333; }
    .type-fairy { background: #EE99AC; color: white; }
    
    .battle-log {
      background: #f8f9fa;
      border: 2px solid #e2e8f0;
      border-radius: 15px;
      padding: 20px;
      height: 200px;
      overflow-y: auto;
      font-family: 'Courier New', monospace;
      box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.06);
    }
    
    .battle-log p {
      margin: 5px 0;
      padding: 5px 10px;
      border-radius: 5px;
      background: white;
      border-left: 3px solid #667eea;
      animation: slideIn 0.3s ease-out;
    }
    
    @keyframes slideIn {
      from {
        opacity: 0;
        transform: translateX(-20px);
      }
      to {
        opacity: 1;
        transform: translateX(0);
      }
    }
    
    .control-buttons {
      text-align: center;
      margin-top: 20px;
    }
    
    .control-btn {
      padding: 12px 30px;
      margin: 0 10px;
      border: none;
      border-radius: 10px;
      font-size: 18px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s;
      color: white;
    }
    
    .start-btn {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    }
    
    .reset-btn {
      background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
    }
    
    .control-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
    }
    
    .control-btn:disabled {
      opacity: 0.5;
      cursor: not-allowed;
      transform: none;
    }
    
    .hidden { display: none; }
    
    .shake {
      animation: shake 0.5s;
    }
    
    @keyframes shake {
      0%, 100% { transform: translateX(0); }
      25% { transform: translateX(-10px); }
      75% { transform: translateX(10px); }
    }
  </style>
</head>
<body>
  <div class="game-container">
    <h1>⚔️ Pokémon Battle Engine ⚔️</h1>
    
    <div class="setup-phase" id="setup-phase">
      <label for="user-select">Choose your Pokémon:</label>
      <select id="user-select">
        <option value="" disabled selected>— Select Pokémon —</option>
      </select>
    </div>
    
    <div class="battle-arena hidden" id="battle-arena">
      <div class="pokemon-card" id="user-pokemon">
        <h2 id="user-pokemon-name">Your Pokémon</h2>
        <img id="user-pokemon-image" src="" alt="User Pokémon"/>
        <div class="hp-container">
          <div class="hp-bar" id="user-hp-bar" style="width: 100%"></div>
        </div>
        <div class="hp-text" id="user-hp-text">HP: 100/100</div>
      </div>
      
      <div class="pokemon-card" id="opponent-pokemon">
        <h2 id="opponent-pokemon-name">Opponent Pokémon</h2>
        <img id="opponent-pokemon-image" src="" alt="Opponent Pokémon"/>
        <div class="hp-container">
          <div class="hp-bar" id="opponent-hp-bar" style="width: 100%"></div>
        </div>
        <div class="hp-text" id="opponent-hp-text">HP: 100/100</div>
      </div>
    </div>
    
    <div class="move-selection hidden" id="move-selection">
      <h3>Choose your move:</h3>
      <div class="move-buttons" id="move-buttons"></div>
    </div>
    
    <div class="battle-log" id="battle-log"></div>
    
    <div class="control-buttons">
      <button class="control-btn start-btn" id="start-btn" onclick="startBattle()">Start Battle!</button>
      <button class="control-btn reset-btn hidden" id="reset-btn" onclick="resetBattle()">New Battle</button>
    </div>
  </div>

  <script>
    // Game state
    let gameState = {
      userPokemon: null,
      opponentPokemon: null,
      userHP: 0,
      userMaxHP: 0,
      oppHP: 0,
      oppMaxHP: 0,
      battleActive: false,
      waitingForMove: false,
      currentTurn: 'user'
    };

    // Pokémon data
    const pokemonStats = {
      "Dialga": [404, 339, 339, 399, 299, 279],
      "Primal Kyogre": [404, 399, 279, 459, 419, 279],
      "Mega Mewtwo Y": [416, 399, 239, 487, 339, 379],
      "Arceus": [444, 339, 339, 339, 339, 339],
      "Primal Groudon": [404, 459, 419, 399, 279, 279],
      "Mega Rayquaza": [414, 459, 299, 459, 299, 329],
      "Xerneas": [456, 361, 289, 361, 295, 297],
      "Yveltal": [456, 361, 289, 361, 295, 297],
      "Ultra Necrozma": [398, 433, 293, 433, 293, 357],
      "Marshadow": [384, 349, 259, 279, 279, 349],
      "Regigigas": [424, 419, 319, 259, 319, 299],
      "Mega Salamence": [394, 389, 359, 339, 279, 339],
      "Mega Gengar": [324, 229, 259, 439, 289, 359],
      "Mega Gallade": [340, 429, 289, 229, 329, 319],
      "Mega Metagross": [364, 389, 399, 309, 319, 319],
      "Mega Blaziken": [364, 419, 259, 359, 259, 299],
      "Calyrex Shadow Rider": [404, 269, 259, 429, 299, 399],
      "Zacian Crowned": [388, 439, 329, 259, 329, 395],
      "Zamazenta Crowned": [388, 359, 389, 259, 389, 355],
      "Miraidon": [404, 269, 299, 369, 329, 369],
      "Koraidon": [404, 369, 329, 269, 299, 369],
      "Ho-Oh": [416, 359, 279, 319, 407, 279],
      "Lugia": [416, 279, 359, 279, 407, 319],
      "Reshiram": [404, 339, 299, 399, 339, 279],
      "Zekrom": [404, 399, 339, 339, 299, 279],
      "Zygarde": [420, 299, 341, 261, 289, 289],
      "Kyurem White": [454, 339, 279, 439, 299, 289],
      "Kyurem Black": [454, 439, 299, 339, 279, 289],
      "Palkia Origin Forme": [384, 339, 299, 399, 339, 339],
      "Lunala": [478, 325, 277, 373, 313, 293],
      "Solgaleo": [478, 373, 313, 325, 277, 293],
      "Mega Swampert": [404, 399, 319, 289, 319, 239]
    };

    const moves = {
      "Roar of Time": { type: "Dragon", basePower: 150, accuracy: 90, category: "special" },
      "Earth Power": { type: "Ground", basePower: 90, accuracy: 100, category: "special" },
      "Flash Cannon": { type: "Steel", basePower: 80, accuracy: 100, category: "special" },
      "Aura Sphere": { type: "Fighting", basePower: 80, accuracy: 100, category: "special" },
      "Power Gem": { type: "Rock", basePower: 80, accuracy: 100, category: "special" },
      "Water Spout": { type: "Water", basePower: 150, accuracy: 100, category: "special" },
      "Grass Knot": { type: "Grass", basePower: 60, accuracy: 100, category: "special" },
      "Ice Beam": { type: "Ice", basePower: 90, accuracy: 100, category: "special" },
      "Body Slam": { type: "Normal", basePower: 85, accuracy: 100, category: "physical" },
      "Future Sight": { type: "Psychic", basePower: 120, accuracy: 100, category: "special" },
      "Ancient Power": { type: "Rock", basePower: 60, accuracy: 100, category: "special" },
      "Psychic": { type: "Psychic", basePower: 90, accuracy: 100, category: "special" },
      "Hyper Beam": { type: "Normal", basePower: 150, accuracy: 90, category: "special" },
      "Judgment": { type: "Normal", basePower: 100, accuracy: 100, category: "special" },
      "Precipice Blades": { type: "Ground", basePower: 120, accuracy: 85, category: "physical" },
      "Stone Edge": { type: "Rock", basePower: 100, accuracy: 80, category: "physical" },
      "Fire Punch": { type: "Fire", basePower: 75, accuracy: 100, category: "physical" },
      "Thunder Punch": { type: "Electric", basePower: 75, accuracy: 100, category: "physical" },
      "Outrage": { type: "Dragon", basePower: 120, accuracy: 100, category: "physical" },
      "Extreme Speed": { type: "Normal", basePower: 80, accuracy: 100, category: "physical" },
      "Crunch": { type: "Dark", basePower: 80, accuracy: 100, category: "physical" },
      "Dragon Ascent": { type: "Flying", basePower: 120, accuracy: 100, category: "physical" },
      "Play Rough": { type: "Fairy", basePower: 90, accuracy: 90, category: "physical" },
      "Close Combat": { type: "Fighting", basePower: 120, accuracy: 100, category: "physical" },
      "Giga Impact": { type: "Normal", basePower: 150, accuracy: 90, category: "physical" },
      "Megahorn": { type: "Bug", basePower: 120, accuracy: 85, category: "physical" },
      "Sky Attack": { type: "Flying", basePower: 140, accuracy: 90, category: "physical" },
      "Dragon Rush": { type: "Dragon", basePower: 100, accuracy: 75, category: "physical" },
      "Focus Blast": { type: "Fighting", basePower: 120, accuracy: 70, category: "special" },
      "Foul Play": { type: "Dark", basePower: 95, accuracy: 100, category: "physical" },
      "Prismatic Laser": { type: "Psychic", basePower: 160, accuracy: 100, category: "special" },
      "Charge Beam": { type: "Electric", basePower: 50, accuracy: 90, category: "special" },
      "Night Slash": { type: "Dark", basePower: 70, accuracy: 100, category: "physical" },
      "Spectral Thief": { type: "Ghost", basePower: 90, accuracy: 100, category: "physical" },
      "Ice Punch": { type: "Ice", basePower: 75, accuracy: 100, category: "physical" },
      "Hammer Arm": { type: "Fighting", basePower: 100, accuracy: 90, category: "physical" },
      "Zen Headbutt": { type: "Psychic", basePower: 80, accuracy: 90, category: "physical" },
      "Knock Off": { type: "Dark", basePower: 65, accuracy: 100, category: "physical" },
      "Fly": { type: "Flying", basePower: 90, accuracy: 95, category: "physical" },
      "Flamethrower": { type: "Fire", basePower: 90, accuracy: 100, category: "special" },
      "Sludge Bomb": { type: "Poison", basePower: 90, accuracy: 100, category: "special" },
      "Shadow Ball": { type: "Ghost", basePower: 80, accuracy: 100, category: "special" },
      "Dream Eater": { type: "Psychic", basePower: 100, accuracy: 100, category: "special" },
      "Dark Pulse": { type: "Dark", basePower: 80, accuracy: 100, category: "special" },
      "Psycho Cut": { type: "Psychic", basePower: 70, accuracy: 100, category: "physical" },
      "Leaf Blade": { type: "Grass", basePower: 90, accuracy: 100, category: "physical" },
      "Meteor Mash": { type: "Steel", basePower: 90, accuracy: 90, category: "physical" },
      "Earthquake": { type: "Ground", basePower: 100, accuracy: 100, category: "physical" },
      "Flare Blitz": { type: "Fire", basePower: 120, accuracy: 100, category: "physical" },
      "Brave Bird": { type: "Flying", basePower: 120, accuracy: 100, category: "physical" },
      "Shadow Claw": { type: "Ghost", basePower: 70, accuracy: 100, category: "physical" },
      "Astral Barrage": { type: "Ghost", basePower: 120, accuracy: 100, category: "special" },
      "Solar Beam": { type: "Grass", basePower: 120, accuracy: 100, category: "special" },
      "Snarl": { type: "Dark", basePower: 55, accuracy: 95, category: "special" },
      "Behemoth Blade": { type: "Steel", basePower: 100, accuracy: 100, category: "physical" },
      "Behemoth Bash": { type: "Steel", basePower: 100, accuracy: 100, category: "physical" },
      "Wild Charge": { type: "Electric", basePower: 90, accuracy: 100, category: "physical" },
      "Dragon Pulse": { type: "Dragon", basePower: 85, accuracy: 100, category: "special" },
      "Electro Drift": { type: "Electric", basePower: 100, accuracy: 100, category: "special" },
      "Overheat": { type: "Fire", basePower: 130, accuracy: 90, category: "special" },
      "Sacred Fire": { type: "Fire", basePower: 100, accuracy: 95, category: "physical" },
      "Iron Head": { type: "Steel", basePower: 80, accuracy: 100, category: "physical" },
      "Aeroblast": { type: "Flying", basePower: 100, accuracy: 95, category: "special" },
      "Thunder": { type: "Electric", basePower: 110, accuracy: 70, category: "special" },
      "Hydro Pump": { type: "Water", basePower: 110, accuracy: 80, category: "special" },
      "Blue Flare": { type: "Fire", basePower: 130, accuracy: 85, category: "special" },
      "Fusion Flare": { type: "Fire", basePower: 100, accuracy: 100, category: "special" },
      "Fusion Bolt": { type: "Electric", basePower: 100, accuracy: 100, category: "physical" },
      "Freeze Shock": { type: "Ice", basePower: 140, accuracy: 90, category: "physical" },
      "Ice Burn": { type: "Ice", basePower: 140, accuracy: 90, category: "special" },
      "Moongeist Beam": { type: "Ghost", basePower: 100, accuracy: 100, category: "special" },
      "Sunsteel Strike": { type: "Steel", basePower: 100, accuracy: 100, category: "physical" },
      "Wave Crash": { type: "Water", basePower: 120, accuracy: 100, category: "physical" },
      "High Jump Kick": { type: "Fighting", basePower: 130, accuracy: 90, category: "physical" },
      "Bolt Strike": { type: "Electric", basePower: 130, accuracy: 85, category: "physical" },
      "Rock Slide": { type: "Rock", basePower: 75, accuracy: 90, category: "physical" },
      "Spacial Rend": { type: "Dragon", basePower: 100, accuracy: 95, category: "special" },
      "Extrasensory": { type: "Psychic", basePower: 80, accuracy: 100, category: "special" },
      "Moonblast": { type: "Fairy", basePower: 95, accuracy: 100, category: "special" }
    };

    const pokemonMoves = {
      "Dialga": ["Roar of Time", "Earth Power", "Flash Cannon", "Aura Sphere"],
      "Primal Kyogre": ["Water Spout", "Ice Beam", "Thunder", "Earth Power"],
      "Mega Mewtwo Y": ["Psychic", "Aura Sphere", "Shadow Ball", "Ice Beam"],
      "Arceus": ["Judgment", "Extreme Speed", "Earth Power", "Shadow Ball"],
      "Primal Groudon": ["Precipice Blades", "Fire Punch", "Stone Edge", "Thunder Punch"],
      "Mega Rayquaza": ["Dragon Ascent", "Extreme Speed", "Earthquake", "Dragon Pulse"],
      "Xerneas": ["Moonblast", "Focus Blast", "Thunder", "Psychic"],
      "Yveltal": ["Dark Pulse", "Oblivion Wing", "Focus Blast", "Heat Wave"],
      "Ultra Necrozma": ["Photon Geyser", "Heat Wave", "Dragon Pulse", "Power Gem"],
      "Marshadow": ["Spectral Thief", "Close Combat", "Shadow Sneak", "Ice Punch"],
      "Regigigas": ["Crush Grip", "Earthquake", "Stone Edge", "Ice Punch"],
      "Mega Salamence": ["Double-Edge", "Earthquake", "Dragon Claw", "Fire Blast"],
      "Mega Gengar": ["Shadow Ball", "Sludge Wave", "Focus Blast", "Thunderbolt"],
      "Mega Gallade": ["Close Combat", "Zen Headbutt", "Leaf Blade", "Ice Punch"],
      "Mega Metagross": ["Meteor Mash", "Zen Headbutt", "Earthquake", "Ice Punch"],
      "Mega Blaziken": ["Flare Blitz", "High Jump Kick", "Stone Edge", "Thunder Punch"],
      "Calyrex Shadow Rider": ["Astral Barrage", "Psyshock", "Draining Kiss", "Nasty Plot"],
      "Zacian Crowned": ["Behemoth Blade", "Play Rough", "Close Combat", "Wild Charge"],
      "Zamazenta Crowned": ["Behemoth Bash", "Close Combat", "Stone Edge", "Ice Fang"],
      "Miraidon": ["Electro Drift", "Draco Meteor", "Overheat", "U-turn"],
      "Koraidon": ["Collision Course", "Flare Blitz", "U-turn", "Dragon Claw"],
      "Ho-Oh": ["Sacred Fire", "Brave Bird", "Earthquake", "Thunder Wave"],
      "Lugia": ["Aeroblast", "Roost", "Thunder Wave", "Whirlwind"],
      "Reshiram": ["Blue Flare", "Draco Meteor", "Earth Power", "Stone Edge"],
      "Zekrom": ["Bolt Strike", "Outrage", "Stone Edge", "Dragon Claw"],
      "Zygarde": ["Thousand Arrows", "Dragon Dance", "Extreme Speed", "Stone Edge"],
      "Kyurem White": ["Ice Burn", "Fusion Flare", "Draco Meteor", "Earth Power"],
      "Kyurem Black": ["Freeze Shock", "Fusion Bolt", "Dragon Claw", "Iron Head"],
      "Palkia Origin Forme": ["Spacial Rend", "Hydro Pump", "Thunder", "Fire Blast"],
      "Lunala": ["Moongeist Beam", "Psyshock", "Focus Blast", "Ice Beam"],
      "Solgaleo": ["Sunsteel Strike", "Flare Blitz", "Earthquake", "Stone Edge"],
      "Mega Swampert": ["Waterfall", "Earthquake", "Ice Punch", "Superpower"]
    };

    const pokemonTypes = {
      "Dialga": ["Steel", "Dragon"],
      "Primal Kyogre": ["Water"],
      "Mega Mewtwo Y": ["Psychic"],
      "Arceus": ["Normal"],
      "Primal Groudon": ["Ground", "Fire"],
      "Mega Rayquaza": ["Dragon", "Flying"],
      "Xerneas": ["Fairy"],
      "Yveltal": ["Dark", "Flying"],
      "Ultra Necrozma": ["Psychic", "Dragon"],
      "Marshadow": ["Fighting", "Ghost"],
      "Regigigas": ["Normal"],
      "Mega Salamence": ["Dragon", "Flying"],
      "Mega Gengar": ["Ghost", "Poison"],
      "Mega Gallade": ["Psychic", "Fighting"],
      "Mega Metagross": ["Steel", "Psychic"],
      "Mega Blaziken": ["Fire", "Fighting"],
      "Calyrex Shadow Rider": ["Psychic", "Ghost"],
      "Zacian Crowned": ["Fairy", "Steel"],
