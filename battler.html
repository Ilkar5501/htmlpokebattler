<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pokémon Battle Engine</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f4f4f4;
            text-align: center;
        }
        .pokemon-container {
            display: flex;
            justify-content: space-around;
            margin: 20px;
        }
        .pokemon {
            text-align: center;
        }
        .hp-bar {
            margin: 10px 0;
        }
        .move-buttons {
            margin: 20px;
        }
        .battle-log {
            margin: 20px;
            padding: 10px;
            border: 1px solid #ccc;
            background-color: #fff;
            height: 150px;
            overflow-y: auto;
        }
    </style>
</head>
<body>
    <h1>Pokémon Battle Engine</h1>
    <div class="pokemon-container">
        <div class="pokemon" id="user-pokemon">
            <h2 id="user-pokemon-name">User Pokémon</h2>
            <img id="user-pokemon-image" src="" alt="User Pokémon" width="150">
            <div class="hp-bar" id="user-hp-bar">HP: 0/0 (0%)</div>
        </div>
        <div class="pokemon" id="opponent-pokemon">
            <h2 id="opponent-pokemon-name">Opponent Pokémon</h2>
            <img id="opponent-pokemon-image" src="" alt="Opponent Pokémon" width="150">
            <div class="hp-bar" id="opponent-hp-bar">HP: 0/0 (0%)</div>
        </div>
    </div>
    <div class="action-buttons">
        <button onclick="selectPokemon()">Select Pokémon</button>
        <button onclick="startBattle()">Start Battle</button>
    </div>
    <div class="move-buttons" id="move-buttons">
        <!-- Move buttons will be dynamically added here -->
    </div>
    <div class="battle-log" id="battle-log">
        <!-- Battle updates will appear here -->
    </div>
    <script>
        // Pokémon stats, moves, types, and type effectiveness
        const pokemonStats = {
            "Dialga": [404, 339, 339, 399, 299, 279],
            "Primal Kyogre": [404, 399, 279, 459, 419, 279],
            "Mega Mewtwo Y": [416, 399, 239, 487, 339, 379],
            "Arceus": [444, 339, 339, 339, 339, 339],
            "Primal Groudon": [404, 459, 419, 399, 279, 279],
            "Mega Rayquaza": [414, 459, 299, 459, 299, 329],
            "Xerneas": [456, 361, 289, 361, 295, 297],
            "Yveltal": [456, 361, 289, 361, 295, 297],
            "Ultra Necrozma": [398, 433, 293, 433, 293, 357],
            "Marshadow": [384, 349, 259, 279, 279, 349],
            "Regigigas": [424, 419, 319, 259, 319, 299],
            "Mega Salamence": [394, 389, 359, 339, 279, 339],
            "Mega Gengar": [324, 229, 259, 439, 289, 359],
            "Mega Gallade": [340, 429, 289, 229, 329, 319],
            "Mega Metagross": [364, 389, 399, 309, 319, 319],
            "Mega Blaziken": [364, 419, 259, 359, 259, 299],
            "Calyrex Shadow Rider": [404, 269, 259, 429, 299, 399],
            "Zacian Crowned": [388, 439, 329, 259, 329, 395],
            "Zamazenta Crowned": [388, 359, 389, 259, 389, 355],
            "Miraidon": [404, 269, 299, 369, 329, 369],
            "Koraidon": [404, 369, 329, 269, 299, 369],
            "Ho-Oh": [416, 359, 279, 319, 407, 279],
            "Lugia": [416, 279, 359, 279, 407, 319],
            "Reshiram": [404, 339, 299, 399, 339, 279],
            "Zekrom": [404, 399, 339, 339, 299, 279],
            "Zygarde": [420, 299, 341, 261, 289, 289],
            "Kyurem White": [454, 339, 279, 439, 299, 289],
            "Kyurem Black": [454, 439, 299, 339, 279, 289],
            "Palkia Origin Forme": [384, 339, 299, 399, 339, 339],
            "Lunala": [478, 325, 277, 373, 313, 293],
            "Solgaleo": [478, 373, 313, 325, 277, 293],
            "Mega Swampert": [404, 399, 319, 289, 319, 239]
        };

        const moves = {
            "Roar of Time": { type: "Dragon", basePower: 150, accuracy: 90 },
            "Earth Power": { type: "Ground", basePower: 90, accuracy: 100 },
            "Flash Cannon": { type: "Steel", basePower: 80, accuracy: 100 },
            "Aura Sphere": { type: "Fighting", basePower: 80, accuracy: 100 },
            "Power Gem": { type: "Rock", basePower: 80, accuracy: 100 },
            "Water Spout": { type: "Water", basePower: 150, accuracy: 100 },
            "Grass Knot": { type: "Grass", basePower: 60, accuracy: 100 },
            "Ice Beam": { type: "Ice", basePower: 90, accuracy: 100 },
            "Body Slam": { type: "Normal", basePower: 85, accuracy: 100 },
            "Future Sight": { type: "Psychic", basePower: 120, accuracy: 100 },
            "Ancient Power": { type: "Rock", basePower: 60, accuracy: 100 },
            "Psychic": { type: "Psychic", basePower: 90, accuracy: 100 },
            "Hyper Beam": { type: "Normal", basePower: 150, accuracy: 90 },
            "Judgment": { type: "Normal", basePower: 100, accuracy: 100 },
            "Precipice Blades": { type: "Ground", basePower: 120, accuracy: 85 },
            "Stone Edge": { type: "Rock", basePower: 100, accuracy: 80 },
            "Fire Punch": { type: "Fire", basePower: 75, accuracy: 100 },
            "Thunder Punch": { type: "Electric", basePower: 75, accuracy: 100 },
            "Outrage": { type: "Dragon", basePower: 120, accuracy: 100 },
            "Extreme Speed": { type: "Normal", basePower: 80, accuracy: 100 },
            "Crunch": { type: "Dark", basePower: 80, accuracy: 100 },
            "Dragon Ascent": { type: "Flying", basePower: 120, accuracy: 100 },
            "Play Rough": { type: "Fairy", basePower: 90, accuracy: 90 },
            "Close Combat": { type: "Fighting", basePower: 120, accuracy: 100 },
            "Giga Impact": { type: "Normal", basePower: 150, accuracy: 90 },
            "Megahorn": { type: "Bug", basePower: 120, accuracy: 85 },
            "Sky Attack": { type: "Flying", basePower: 140, accuracy: 90 },
            "Dragon Rush": { type: "Dragon", basePower: 100, accuracy: 75 },
            "Focus Blast": { type: "Fighting", basePower: 120, accuracy: 70 },
            "Foul Play": { type: "Dark", basePower: 95, accuracy: 100 },
            "Prismatic Laser": { type: "Psychic", basePower: 160, accuracy: 100 },
            "Charge Beam": { type: "Electric", basePower: 50, accuracy: 90 },
            "Night Slash": { type: "Dark", basePower: 70, accuracy: 100 },
            "Spectral Thief": { type: "Ghost", basePower: 90, accuracy: 100 },
            "Ice Punch": { type: "Ice", basePower: 75, accuracy: 100 },
            "Hammer Arm": { type: "Fighting", basePower: 100, accuracy: 90 },
            "Zen Headbutt": { type: "Psychic", basePower: 80, accuracy: 90 },
            "Knock Off": { type: "Dark", basePower: 65, accuracy: 100 },
            "Fly": { type: "Flying", basePower: 90, accuracy: 95 },
            "Flamethrower": { type: "Fire", basePower: 90, accuracy: 100 },
            "Sludge Bomb": { type: "Poison", basePower: 90, accuracy: 100 },
            "Shadow Ball": { type: "Ghost", basePower: 80, accuracy: 100 },
            "Dream Eater": { type: "Psychic", basePower: 100, accuracy: 100 },
            "Dark Pulse": { type: "Dark", basePower: 80, accuracy: 100 },
            "Psycho Cut": { type: "Psychic", basePower: 70, accuracy: 100 },
            "Leaf Blade": { type: "Grass", basePower: 90, accuracy: 100 },
            "Meteor Mash": { type: "Steel", basePower: 90, accuracy: 90 },
            "Earthquake": { type: "Ground", basePower: 100, accuracy: 100 },
            "Flare Blitz": { type: "Fire", basePower: 120, accuracy: 100 },
            "Brave Bird": { type: "Flying", basePower: 120, accuracy: 100 },
            "Shadow Claw": { type: "Ghost", basePower: 70, accuracy: 100 },
            "Astral Barrage": { type: "Ghost", basePower: 120, accuracy: 100 },
            "Solar Beam": { type: "Grass", basePower: 120, accuracy: 100 },
            "Snarl": { type: "Dark", basePower: 55, accuracy: 95 },
            "Behemoth Blade": { type: "Steel", basePower: 100, accuracy: 100 },
            "Behemoth Bash": { type: "Steel", basePower: 100, accuracy: 100 },
            "Wild Charge": { type: "Electric", basePower: 90, accuracy: 100 },
            "Dragon Pulse": { type: "Dragon", basePower: 85, accuracy: 100 },
            "Electro Drift": { type: "Electric", basePower: 100, accuracy: 100 },
            "Overheat": { type: "Fire", basePower: 130, accuracy: 90 },
            "Sacred Fire": { type: "Fire", basePower: 100, accuracy: 95 },
            "Iron Head": { type: "Steel", basePower: 80, accuracy: 100 },
            "Aeroblast": { type: "Flying", basePower: 100, accuracy: 95 },
            "Thunder": { type: "Electric", basePower: 110, accuracy: 70 },
            "Hydro Pump": { type: "Water", basePower: 110, accuracy: 80 },
            "Blue Flare": { type: "Fire", basePower: 130, accuracy: 85 },
            "Fusion Flare": { type: "Fire", basePower: 100, accuracy: 100 },
            "Fusion Bolt": { type: "Electric", basePower: 100, accuracy: 100 },
            "Freeze Shock": { type: "Ice", basePower: 140, accuracy: 90 },
            "Ice Burn": { type: "Ice", basePower: 140, accuracy: 90 },
            "Moongeist Beam": { type: "Ghost", basePower: 100, accuracy: 100 },
            "Sunsteel Strike": { type: "Steel", basePower: 100, accuracy: 100 },
            "Wave Crash": { type: "Water", basePower: 120, accuracy: 100 }
        };

        const pokemonMoves = {
            "Dialga": ["Roar of Time", "Earth Power", "Flash Cannon", "Aura Sphere", "Power Gem"],
            "Primal Kyogre": ["Water Spout", "Grass Knot", "Ice Beam", "Body Slam"],
            "Mega Mewtwo Y": ["Future Sight", "Ancient Power", "Psychic"],
            "Arceus": ["Hyper Beam", "Future Sight", "Earth Power", "Judgment"],
            "Primal Groudon": ["Precipice Blades", "Stone Edge", "Fire Punch", "Thunder Punch"],
            "Mega Rayquaza": ["Outrage", "Extreme Speed", "Crunch", "Dragon Ascent"],
            "Xerneas": ["Play Rough", "Close Combat", "Giga Impact", "Megahorn"],
            "Yveltal": ["Sky Attack", "Dragon Rush", "Focus Blast", "Foul Play"],
            "Ultra Necrozma": ["Prismatic Laser", "Power Gem", "Charge Beam", "Night Slash"],
            "Marshadow": ["Close Combat", "Spectral Thief", "Ice Punch", "Fire Punch"],
            "Regigigas": ["Giga Impact", "Hammer Arm", "Zen Headbutt", "Knock Off"],
            "Mega Salamence": ["Outrage", "Fly", "Flamethrower", "Crunch"],
            "Mega Gengar": ["Sludge Bomb", "Shadow Ball", "Dream Eater", "Dark Pulse"],
            "Mega Gallade": ["Close Combat", "Psycho Cut", "Leaf Blade", "Night Slash"],
            "Mega Metagross": ["Meteor Mash", "Zen Headbutt", "Hammer Arm", "Earthquake"],
            "Mega Blaziken": ["High Jump Kick", "Flare Blitz", "Brave Bird", "Shadow Claw"],
            "Calyrex Shadow Rider": ["Astral Barrage", "Solar Beam", "Future Sight", "Snarl"],
            "Zacian Crowned": ["Play Rough", "Behemoth Blade", "Giga Impact", "Zen Headbutt"],
            "Zamazenta Crowned": ["Close Combat", "Behemoth Bash", "Wild Charge", "Crunch"],
            "Miraidon": ["Dragon Pulse", "Electro Drift", "Overheat", "Hyper Beam"],
            "Koraidon": ["Close Combat", "Outrage", "Flare Blitz", "Giga Impact"],
            "Ho-Oh": ["Sky Attack", "Sacred Fire", "Iron Head", "Zen Headbutt"],
            "Lugia": ["Aeroblast", "Thunder", "Hydro Pump", "Future Sight"],
            "Reshiram": ["Blue Flare", "Dragon Pulse", "Earth Power", "Extrasensory"],
            "Zekrom": ["Bolt Strike", "Outrage", "Crunch", "Rock Slide"],
            "Zygarde": ["Earthquake", "Outrage", "Crunch", "Stone Edge"],
            "Kyurem White": ["Ice Burn", "Fusion Flare", "Dragon Pulse", "Psychic"],
            "Kyurem Black": ["Outrage", "Freeze Shock", "Fusion Bolt", "Shadow Claw"],
            "Palkia Origin Forme": ["Spacial Rend", "Hydro Pump", "Earth Power", "Power Gem"],
            "Lunala": ["Future Sight", "Moongeist Beam", "Focus Blast", "Moonblast"],
            "Solgaleo": ["Sunsteel Strike", "Zen Headbutt", "Giga Impact", "Crunch"],
            "Mega Swampert": ["Earthquake", "Wave Crash", "Hammer Arm", "Stone Edge"]
        };


        const pokemonTypes = {
            "Dialga": ["Dragon", "Steel"],
            "Primal Kyogre": ["Water"],
            "Mega Mewtwo Y": ["Psychic"],
            "Arceus": ["Normal"],
            "Primal Groudon": ["Ground", "Fire"],
            "Mega Rayquaza": ["Dragon", "Flying"],
            "Xerneas": ["Fairy"],
            "Yveltal": ["Dark", "Flying"],
            "Ultra Necrozma": ["Psychic", "Dragon"],
            "Marshadow": ["Fighting", "Ghost"],
            "Regigigas": ["Normal"],
            "Mega Salamence": ["Dragon", "Flying"],
            "Mega Gengar": ["Ghost", "Poison"],
            "Mega Gallade": ["Psychic", "Fighting"],
            "Mega Metagross": ["Steel", "Psychic"],
            "Mega Blaziken": ["Fire", "Fighting"],
            "Calyrex Shadow Rider": ["Psychic", "Ghost"],
            "Zacian Crowned": ["Fairy", "Steel"],
            "Zamazenta Crowned": ["Fighting", "Steel"],
            "Miraidon": ["Electric", "Dragon"],
            "Koraidon": ["Fighting", "Dragon"],
            "Ho-Oh": ["Fire", "Flying"],
            "Lugia": ["Psychic", "Flying"],
            "Reshiram": ["Dragon", "Fire"],
            "Zekrom": ["Dragon", "Electric"],
            "Zygarde": ["Dragon", "Ground"],
            "Kyurem White": ["Dragon", "Ice"],
            "Kyurem Black": ["Dragon", "Ice"],
            "Palkia Origin Forme": ["Water", "Dragon"],
            "Lunala": ["Psychic", "Ghost"],
            "Solgaleo": ["Steel", "Psychic"],
            "Mega Swampert": ["Water", "Ground"]
        };

        const typeChart = {
            "Normal": { "Rock": 0.5, "Ghost": 0, "Steel": 0.5 },
            "Fire": { "Fire": 0.5, "Water": 0.5, "Grass": 2, "Ice": 2, "Bug": 2, "Rock": 0.5, "Dragon": 0.5, "Steel": 2 },
            "Water": { "Fire": 2, "Water": 0.5, "Grass": 0.5, "Ground": 2, "Rock": 2, "Dragon": 0.5 },
            "Electric": { "Water": 2, "Electric": 0.5, "Grass": 0.5, "Ground": 0, "Flying": 2, "Dragon": 0.5 },
            "Grass": { "Fire": 0.5, "Water": 2, "Grass": 0.5, "Poison": 0.5, "Ground": 2, "Flying": 0.5, "Bug": 0.5, "Rock": 2, "Dragon": 0.5, "Steel": 0.5 },
            "Ice": { "Fire": 0.5, "Water": 0.5, "Grass": 2, "Ice": 0.5, "Ground": 2, "Flying": 2, "Dragon": 2, "Steel": 0.5 },
            "Fighting": { "Normal": 2, "Ice": 2, "Rock": 2, "Dark": 2, "Steel": 2, "Poison": 0.5, "Flying": 0.5, "Psychic": 0.5, "Bug": 0.5, "Fairy": 0.5, "Ghost": 0 },
            "Poison": { "Grass": 2, "Poison": 0.5, "Ground": 0.5, "Rock": 0.5, "Ghost": 0.5, "Steel": 0, "Fairy": 2 },
            "Ground": { "Fire": 2, "Electric": 2, "Grass": 0.5, "Poison": 2, "Flying": 0, "Bug": 0.5, "Rock": 2, "Steel": 2 },
            "Flying": { "Electric": 0.5, "Grass": 2, "Fighting": 2, "Bug": 2, "Rock": 0.5, "Steel": 0.5 },
            "Psychic": { "Fighting": 2, "Poison": 2, "Psychic": 0.5, "Dark": 0, "Steel": 0.5 },
            "Bug": { "Fire": 0.5, "Grass": 2, "Fighting": 0.5, "Poison": 0.5, "Flying": 0.5, "Psychic": 2, "Ghost": 0.5, "Dark": 2, "Steel": 0.5, "Fairy": 0.5 },
            "Rock": { "Fire": 2, "Ice": 2, "Fighting": 0.5, "Ground": 0.5, "Flying": 2, "Bug": 2, "Steel": 0.5 },
            "Ghost": { "Normal": 0, "Psychic": 2, "Ghost": 2, "Dark": 0.5 },
            "Dragon": { "Dragon": 2, "Steel": 0.5, "Fairy": 0 },
            "Dark": { "Fighting": 0.5, "Psychic": 2, "Ghost": 2, "Dark": 0.5, "Fairy": 0.5 },
            "Steel": { "Fire": 0.5, "Water": 0.5, "Electric": 0.5, "Ice": 2, "Rock": 2, "Steel": 0.5, "Fairy": 2 },
            "Fairy": { "Fire": 0.5, "Fighting": 2, "Poison": 0.5, "Dragon": 2, "Dark": 2, "Steel": 0.5 }
        };

        const pokemonImages = {
            "Dialga": "https://img.pokemondb.net/artwork/large/dialga.jpg",
            "Primal Kyogre": "https://img.pokemondb.net/artwork/large/kyogre-primal.jpg",
            "Mega Mewtwo Y": "https://img.pokemondb.net/artwork/large/mewtwo-mega-y.jpg",
            "Arceus": "https://img.pokemondb.net/artwork/large/arceus.jpg",
            "Primal Groudon": "https://img.pokemondb.net/artwork/large/groudon-primal.jpg",
            "Mega Rayquaza": "https://img.pokemondb.net/artwork/large/rayquaza-mega.jpg",
            "Xerneas": "https://img.pokemondb.net/artwork/large/xerneas.jpg",
            "Yveltal": "https://img.pokemondb.net/artwork/large/yveltal.jpg",
            "Ultra Necrozma": "https://img.pokemondb.net/artwork/large/necrozma-ultra.jpg",
            "Marshadow": "https://img.pokemondb.net/artwork/large/marshadow.jpg",
            "Regigigas": "https://img.pokemondb.net/artwork/large/regigigas.jpg",
            "Mega Salamence": "https://img.pokemondb.net/artwork/large/salamence-mega.jpg",
            "Mega Gengar": "https://img.pokemondb.net/artwork/large/gengar-mega.jpg",
            "Mega Gallade": "https://img.pokemondb.net/artwork/large/gallade-mega.jpg",
            "Mega Metagross": "https://img.pokemondb.net/artwork/large/metagross-mega.jpg",
            "Mega Blaziken": "https://img.pokemondb.net/artwork/large/blaziken-mega.jpg",
            "Calyrex Shadow Rider": "https://img.pokemondb.net/artwork/large/calyrex-shadow-rider.jpg",
            "Zacian Crowned": "https://img.pokemondb.net/artwork/large/zacian-crowned.jpg",
            "Zamazenta Crowned": "https://img.pokemondb.net/artwork/large/zamazenta-crowned.jpg",
            "Miraidon": "https://img.pokemondb.net/artwork/large/miraidon.jpg",
            "Koraidon": "https://img.pokemondb.net/artwork/large/koraidon.jpg",
            "Ho-Oh": "https://img.pokemondb.net/artwork/large/ho-oh.jpg",
            "Lugia": "https://img.pokemondb.net/artwork/large/lugia.jpg",
            "Reshiram": "https://img.pokemondb.net/artwork/large/reshiram.jpg",
            "Zekrom": "https://img.pokemondb.net/artwork/large/zekrom.jpg",
            "Zygarde": "https://img.pokemondb.net/artwork/large/zygarde.jpg",
            "Kyurem White": "https://img.pokemondb.net/artwork/large/kyurem-white.jpg",
            "Kyurem Black": "https://img.pokemondb.net/artwork/large/kyurem-black.jpg",
            "Palkia Origin Forme": "https://img.pokemondb.net/artwork/large/palkia-origin.jpg",
            "Lunala": "https://img.pokemondb.net/artwork/large/lunala.jpg",
            "Solgaleo": "https://img.pokemondb.net/artwork/large/solgaleo.jpg",
            "Mega Swampert": "https://img.pokemondb.net/artwork/large/swampert-mega.jpg"
        };

        const pokemonList = Object.keys(pokemonStats);

        function selectPokemon() {
            // Randomly select Pokémon for user and opponent
            const userPokemon = pokemonList[Math.floor(Math.random() * pokemonList.length)];
            const opponentPokemon = pokemonList[Math.floor(Math.random() * pokemonList.length)];

            // Update Pokémon names and images
            document.getElementById("user-pokemon-name").innerText = userPokemon;
            document.getElementById("user-pokemon-image").src = pokemonImages[userPokemon];
            document.getElementById("user-pokemon-image").style.display = "block";

            document.getElementById("opponent-pokemon-name").innerText = opponentPokemon;
            document.getElementById("opponent-pokemon-image").src = pokemonImages[opponentPokemon];
            document.getElementById("opponent-pokemon-image").style.display = "block";

            // Initialize HP bars
            const userHP = pokemonStats[userPokemon][0];
            const opponentHP = pokemonStats[opponentPokemon][0];
            document.getElementById("user-hp-bar").innerText = `HP: ${userHP}/${userHP} (100%)`;
            document.getElementById("opponent-hp-bar").innerText = `HP: ${opponentHP}/${opponentHP} (100%)`;

            // Store selected Pokémon for the battle
            window.selectedUserPokemon = userPokemon;
            window.selectedOpponentPokemon = opponentPokemon;
        }

            function startBattle() {
        if (!window.selectedUserPokemon || !window.selectedOpponentPokemon) {
            alert("Please select Pokémon first!");
            return;
        }

            // Start the battle
            const userPokemon = window.selectedUserPokemon;
            const opponentPokemon = window.selectedOpponentPokemon;
            startBattleLogic(userPokemon, opponentPokemon);
        }

        // Battle engine logic
        function startBattle(userPokemon, opponentPokemon) {
        // Set Pokémon images
        document.getElementById("user-pokemon-image").src = pokemonImages[userPokemon];
        document.getElementById("user-pokemon-image").style.display = "block";
        document.getElementById("opponent-pokemon-image").src = pokemonImages[opponentPokemon];
        document.getElementById("opponent-pokemon-image").style.display = "block";

        // Initialize stats, moves, and HP
        let userHP = pokemonStats[userPokemon][0];
        let opponentHP = pokemonStats[opponentPokemon][0];
        const userSpeed = pokemonStats[userPokemon][5];
        const opponentSpeed = pokemonStats[opponentPokemon][5];

        // Determine attack order
        let userGoesFirst = userSpeed > opponentSpeed || (userSpeed === opponentSpeed && Math.random() < 0.5);

        // Battle loop
        while (userHP > 0 && opponentHP > 0) {
            if (userGoesFirst) {
                // User attacks
                opponentHP = attack(userPokemon, opponentPokemon, opponentHP);
                if (opponentHP <= 0) break;
            } else {
                // Opponent attacks
                userHP = attack(opponentPokemon, userPokemon, userHP);
                if (userHP <= 0) break;
            }
            userGoesFirst = !userGoesFirst; // Alternate turns
        }

        // Determine winner
        if (userHP > 0) {
            logBattle(`${userPokemon} wins!`);
        } else {
            logBattle(`${opponentPokemon} wins!`);
        }
    }

        function attack(attacker, defender, defenderHP) {
            // Select a move
            const move = pokemonMoves[attacker][Math.floor(Math.random() * pokemonMoves[attacker].length)];
            const moveData = moves[move];

            // Accuracy check
            if (Math.random() * 100 > moveData.accuracy) {
                logBattle(`${attacker}'s ${move} missed!`);
                return defenderHP;
            }

            // Calculate damage
            const attackStat = moveData.type === "Physical" ? pokemonStats[attacker][1] : pokemonStats[attacker][3];
            const defenseStat = moveData.type === "Physical" ? pokemonStats[defender][2] : pokemonStats[defender][4];
            const stab = pokemonTypes[attacker].includes(moveData.type) ? 1.5 : 1;
            const typeEffectiveness = pokemonTypes[defender].reduce((multiplier, type) => {
                return multiplier * (typeChart[moveData.type][type] || 1);
            }, 1);
            const randomFactor = Math.random() * 0.15 + 0.85;
            const damage = Math.floor((((2 * 100 / 5 + 2) * moveData.basePower * (attackStat / defenseStat)) / 50 + 2) * stab * typeEffectiveness * randomFactor);

            // Apply damage
            defenderHP -= damage;
            logBattle(`${attacker} used ${move}! It dealt ${damage} damage.`);
            return Math.max(0, defenderHP);
        }

        function logBattle(message) {
            const log = document.getElementById("battle-log");
            log.innerHTML += `<p>${message}</p>`;
            log.scrollTop = log.scrollHeight;
        }
    </script>
</body>
</html>
